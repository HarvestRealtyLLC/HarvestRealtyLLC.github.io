<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Details | Harvest Realty LLC</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@300;400;600;700&family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --burgundy: #8B2E2E;
            --burgundy-dark: #6B1E1E;
            --gold: #D4AF37;
            --gold-dark: #B8941F;
            --cream: #F5F1E8;
            --cream-dark: #E8E0D0;
            --charcoal: #2C2C2C;
            --white: #FFFFFF;
            --shadow: rgba(139, 46, 46, 0.15);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Montserrat', sans-serif; background: var(--cream); color: var(--charcoal); line-height: 1.6; }
        h1, h2, h3 { font-family: 'Cormorant Garamond', serif; }
        
        /* Header */
        header {
            position: fixed; width: 100%; top: 0; z-index: 1000;
            background: linear-gradient(180deg, rgba(255,255,255,0.98) 0%, rgba(245,241,232,0.95) 100%);
            backdrop-filter: blur(10px); box-shadow: 0 2px 20px var(--shadow);
        }
        
        nav {
            max-width: 1400px; margin: 0 auto;
            display: flex; justify-content: space-between; align-items: center;
            padding: 1rem 3rem;
        }
        
        .logo-container {
            display: flex; align-items: center; gap: 1rem; text-decoration: none;
        }
        
        .logo-container img { height: 60px; }
        
        .logo-text h1 { font-size: 1.8rem; color: var(--burgundy); margin-bottom: 0.2rem; }
        .logo-text p { font-size: 0.85rem; color: var(--gold-dark); letter-spacing: 2px; text-transform: uppercase; font-weight: 500; }
        
        .nav-links { display: flex; gap: 2rem; list-style: none; align-items: center; }
        .nav-links a { text-decoration: none; color: var(--charcoal); font-weight: 500; transition: color 0.3s; }
        .nav-links a:hover { color: var(--burgundy); }
        
        .mobile-menu-toggle {
            display: none; background: none; border: none;
            font-size: 1.8rem; color: var(--burgundy); cursor: pointer;
        }
        
        /* Main Content */
        main { max-width: 1200px; margin: 0 auto; padding: 120px 2rem 3rem; }
        
        /* Property Layout */
        .property-hero {
            display: grid; grid-template-columns: 1.5fr 1fr; gap: 2rem; margin-bottom: 2rem;
        }
        
        .property-image-main {
            width: 100%; height: 450px; object-fit: cover;
            border-radius: 20px; box-shadow: 0 10px 40px var(--shadow);
            background: var(--cream-dark);
        }
        
        .property-summary {
            background: var(--white); border-radius: 20px; padding: 2rem;
            box-shadow: 0 10px 40px var(--shadow);
        }
        
        .property-status {
            display: inline-block; padding: 0.5rem 1rem; border-radius: 20px;
            font-size: 0.85rem; font-weight: 600; margin-bottom: 1rem;
        }
        
        .status-active { background: rgba(76, 175, 80, 0.9); color: var(--white); }
        .status-under-contract { background: rgba(255, 193, 7, 0.9); color: var(--charcoal); }
        .status-sold { background: rgba(139, 46, 46, 0.9); color: var(--white); }
        .status-rental { background: rgba(33, 150, 243, 0.9); color: var(--white); }
        
        .property-price {
            font-size: 2.5rem; color: var(--burgundy); font-weight: 700;
            font-family: 'Cormorant Garamond', serif; margin-bottom: 0.5rem;
        }
        
        .property-address { font-size: 1.2rem; color: var(--charcoal); margin-bottom: 1rem; }
        .property-mls { font-size: 0.9rem; color: #888; margin-bottom: 1.5rem; }
        
        .property-features {
            display: flex; gap: 1.5rem; flex-wrap: wrap;
            padding: 1rem 0; border-top: 2px solid var(--cream); border-bottom: 2px solid var(--cream);
            margin-bottom: 1.5rem;
        }
        
        .feature { display: flex; align-items: center; gap: 0.5rem; font-size: 1rem; }
        
        .btn-primary {
            display: block; width: 100%; padding: 1rem;
            background: linear-gradient(135deg, var(--burgundy) 0%, var(--burgundy-dark) 100%);
            color: var(--white); text-align: center; text-decoration: none;
            border-radius: 50px; font-weight: 600; transition: all 0.3s; margin-bottom: 1rem;
        }
        
        .btn-primary:hover { transform: translateY(-3px); box-shadow: 0 10px 30px var(--shadow); }
        
        .btn-secondary {
            display: block; width: 100%; padding: 1rem;
            background: var(--gold); color: var(--charcoal); text-align: center;
            text-decoration: none; border-radius: 50px; font-weight: 600; transition: all 0.3s;
        }
        
        .btn-secondary:hover { transform: translateY(-3px); }
        
        /* Property Details Section */
        .property-details {
            background: var(--white); border-radius: 20px; padding: 2rem;
            box-shadow: 0 10px 40px var(--shadow); margin-bottom: 2rem;
        }
        
        .property-details h2 { color: var(--burgundy); margin-bottom: 1rem; font-size: 1.8rem; }
        .property-details p { margin-bottom: 1rem; }
        .property-details ul { margin-left: 1.5rem; margin-bottom: 1rem; }
        .property-details li { margin-bottom: 0.5rem; }
        
        /* Agent Card */
        .agent-card {
            background: var(--white); border-radius: 20px; padding: 2rem;
            box-shadow: 0 10px 40px var(--shadow); text-align: center;
        }
        
        .agent-card h3 { color: var(--burgundy); margin-bottom: 0.5rem; }
        .agent-card p { color: #666; margin-bottom: 1rem; }
        .agent-contact a { display: block; color: var(--charcoal); text-decoration: none; margin: 0.5rem 0; }
        .agent-contact a:hover { color: var(--burgundy); }
        
        /* Back Link */
        .back-link {
            display: inline-flex; align-items: center; gap: 0.5rem;
            color: var(--burgundy); text-decoration: none; font-weight: 600; margin-bottom: 1.5rem;
        }
        
        .back-link:hover { color: var(--burgundy-dark); }
        
        /* External Links */
        .external-links {
            display: flex; gap: 1rem; justify-content: center; margin-top: 1.5rem;
        }
        
        .external-links a {
            display: flex; align-items: center; justify-content: center;
            width: 50px; height: 50px; border-radius: 50%; overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.15);
        }
        
        .external-links img { width: 100%; height: 100%; object-fit: cover; }
        
        /* Loading State */
        .loading {
            text-align: center; padding: 4rem; color: var(--charcoal);
        }
        
        .loading-spinner {
            width: 50px; height: 50px; border: 4px solid var(--cream-dark);
            border-top-color: var(--burgundy); border-radius: 50%;
            animation: spin 1s linear infinite; margin: 0 auto 1rem;
        }
        
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Error State */
        .error-state {
            text-align: center; padding: 4rem; background: var(--white);
            border-radius: 20px; box-shadow: 0 10px 40px var(--shadow);
        }
        
        .error-state h2 { color: var(--burgundy); margin-bottom: 1rem; }
        
        /* Footer */
        footer {
            background: var(--charcoal); color: var(--white);
            text-align: center; padding: 2rem; margin-top: 3rem;
        }
        
        footer a { color: var(--gold); text-decoration: none; }
        
        /* Mobile Responsive */
        @media (max-width: 900px) {
            .property-hero { grid-template-columns: 1fr; }
            .property-image-main { height: 300px; }
            nav { padding: 1rem; }
            .nav-links {
                display: none; position: absolute; top: 100%; left: 0; right: 0;
                background: var(--white); flex-direction: column; padding: 1rem;
                box-shadow: 0 5px 20px var(--shadow);
            }
            .nav-links.active { display: flex; }
            .mobile-menu-toggle { display: block; }
            .logo-container img { height: 45px; }
            .logo-text h1 { font-size: 1.4rem; }
            main { padding: 100px 1rem 2rem; }
        }
    </style>
</head>
<body>
    <header>
        <nav>
            <a href="index.html" class="logo-container">
                <img src="hrg-logo.png" alt="Harvest Realty LLC Logo" onerror="this.style.display='none'">
                <div class="logo-text">
                    <h1>Harvest Realty LLC</h1>
                    <p>PA & NJ Experts</p>
                </div>
            </a>
            <button class="mobile-menu-toggle" id="mobileMenuToggle">‚ò∞</button>
            <div class="nav-links" id="navLinks">
                <a href="index.html">Home</a>
                <a href="properties.html">Properties</a>
                <a href="index.html#team">Our Team</a>
                <a href="partners.html">Partners</a>
                <a href="index.html#contact">Contact</a>
            </div>
        </nav>
    </header>

    <main id="mainContent">
        <div class="loading">
            <div class="loading-spinner"></div>
            <p>Loading property details...</p>
        </div>
    </main>

    <footer>
        <p>&copy; 2026 Harvest Realty LLC. All rights reserved.</p>
        <p style="margin-top: 0.5rem;"><a href="index.html">harvestrealty.llc</a></p>
    
            <p style="margin-top: 1rem; font-size: 0.8rem; opacity: 0.7;">
                Designed & Built by <a href="https://chronosmedia.to" target="_blank" style="color: #D4AF37; text-decoration: none; font-weight: 500;">Chronos Media LLC</a> ‚è≥
            </p>
    </footer>

    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://zzjunmkcdpdxhmhiggno.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp6anVubWtjZHBkeGhtaGlnZ25vIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgyNzM1MDIsImV4cCI6MjA4Mzg0OTUwMn0.HYHck2haMWyEQh1sSXGjh9nWqPXmfvXeE60HBTVx-KM';
        
        // Get property ID from URL
        function getPropertyId() {
            const params = new URLSearchParams(window.location.search);
            return params.get('id');
        }
        
        // Load property from Supabase using REST API
        async function loadProperty() {
            const propertyId = getPropertyId();
            
            if (!propertyId) {
                showError('No property specified');
                return;
            }
            
            try {
                const response = await fetch(
                    `${SUPABASE_URL}/rest/v1/listings?id=eq.${propertyId}&select=*`,
                    {
                        headers: {
                            'apikey': SUPABASE_ANON_KEY,
                            'Authorization': `Bearer ${SUPABASE_ANON_KEY}`,
                            'Content-Type': 'application/json'
                        }
                    }
                );
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const listings = await response.json();
                const property = listings[0];
                
                if (!property) {
                    showError('Property not found');
                    return;
                }
                
                renderProperty(property);
                
                // Update page title
                document.title = `${property.address} | Harvest Realty LLC`;
                
            } catch (err) {
                console.error('Error:', err);
                showError('Unable to load property');
            }
        }
        
        // Render property details
        function renderProperty(property) {
            const main = document.getElementById('mainContent');
            const statusClass = getStatusClass(property.status);
            const featuresHTML = getFeaturesHTML(property);
            const priceDisplay = formatPrice(property.price);
            const photoUrl = property.photo_url || 'photos/placeholder.jpg';
            const addressForZillow = encodeURIComponent(property.address.replace(/,/g, '').replace(/\s+/g, '-'));
            
            // Agent info
            const agent = property.agents || {};
            const agentName = agent.name || 'Harvest Realty Agent';
            const agentRole = agent.role || 'Sales Agent';
            const agentPhone = agent.phone || '215-519-4096';
            const agentEmail = agent.email || 'contact@harvestrealty.llc';
            
            main.innerHTML = `
                <a href="properties.html" class="back-link">‚Üê Back to All Properties</a>
                
                <div class="property-hero">
                    <img src="${photoUrl}" alt="${property.address}" class="property-image-main" onerror="this.src='photos/placeholder.jpg'">
                    
                    <div class="property-summary">
                        <span class="property-status ${statusClass}">${property.status}</span>
                        <div class="property-price">${priceDisplay}</div>
                        <div class="property-address">üìç ${property.address}</div>
                        <div class="property-mls">MLS# ${property.mls_number || 'Pending'}</div>
                        
                        <div class="property-features">
                            ${featuresHTML}
                        </div>
                        
                        <a href="https://cal.com/harvestrealtyllc/propertyshowing" target="_blank" class="btn-primary">üìÖ Schedule a Showing</a>
                        <a href="tel:${agentPhone}" class="btn-secondary">üìû Call Agent</a>
                        
                        <div class="external-links">
                            <a href="https://www.zillow.com/homes/${addressForZillow}_rb/" target="_blank" title="View on Zillow">
                                <img src="photos/zillow-logo.png" alt="Zillow" onerror="this.parentElement.style.display='none'">
                            </a>
                        </div>
                    </div>
                </div>
                
                <div class="property-details">
                    <h2>Property Description</h2>
                    <p>${property.description || `Beautiful ${property.property_type || 'property'} located at ${property.address}. Contact us today to learn more about this listing!`}</p>
                    ${property.features ? `<p><strong>Features:</strong> ${property.features}</p>` : ''}
                    
                    <h2 style="margin-top: 2rem;">Property Details</h2>
                    <ul>
                        <li>Property Type: ${property.property_type || 'Residential'}</li>
                        <li>Status: ${property.status}</li>
                        ${property.mls_number ? `<li>MLS#: ${property.mls_number}</li>` : ''}
                        ${property.beds ? `<li>Bedrooms: ${property.beds}</li>` : ''}
                        ${property.baths ? `<li>Bathrooms: ${property.baths}</li>` : ''}
                        ${property.sqft ? `<li>Square Feet: ${property.sqft.toLocaleString()}</li>` : ''}
                    </ul>
                </div>
                
                <div class="agent-card">
                    <h3>Listed By</h3>
                    <p>${agentName}</p>
                    <p style="font-size: 0.9rem; color: var(--burgundy);">${agentRole}</p>
                    <div class="agent-contact">
                        <a href="tel:${agentPhone}">üìû ${agentPhone}</a>
                        <a href="mailto:${agentEmail}">üìß ${agentEmail}</a>
                    </div>
                </div>
            `;
        }
        
        // Helper functions
        function getStatusClass(status) {
            const statusMap = {
                'Active': 'status-active',
                'Under Contract': 'status-under-contract',
                'Sold': 'status-sold',
                'Rental': 'status-rental'
            };
            return statusMap[status] || 'status-active';
        }
        
        function getFeaturesHTML(property) {
            const features = [];
            if (property.beds) features.push(`<div class="feature">üõèÔ∏è ${property.beds} Beds</div>`);
            if (property.baths) features.push(`<div class="feature">üöø ${property.baths} Baths</div>`);
            if (property.sqft) features.push(`<div class="feature">üìê ${property.sqft.toLocaleString()} sqft</div>`);
            if (!features.length && property.property_type) {
                features.push(`<div class="feature">üìã ${property.property_type}</div>`);
            }
            return features.join('');
        }
        
        function formatPrice(price) {
            if (!price) return 'Contact for Price';
            if (typeof price === 'string' && price.includes('$')) return price;
            return '$' + Number(price).toLocaleString();
        }
        
        function showError(message) {
            document.getElementById('mainContent').innerHTML = `
                <div class="error-state">
                    <h2>üòî ${message}</h2>
                    <p>The property you're looking for may have been removed or is no longer available.</p>
                    <a href="properties.html" style="display: inline-block; margin-top: 1.5rem; padding: 1rem 2rem; background: var(--burgundy); color: white; text-decoration: none; border-radius: 50px; font-weight: 600;">Browse All Properties</a>
                </div>
            `;
        }
        
        // Mobile menu toggle
        document.getElementById('mobileMenuToggle').addEventListener('click', function() {
            const navLinks = document.getElementById('navLinks');
            navLinks.classList.toggle('active');
            this.textContent = navLinks.classList.contains('active') ? '‚úï' : '‚ò∞';
        });
        
        // Load property on page load
        document.addEventListener('DOMContentLoaded', loadProperty);
    </script>
</body>
</html>
